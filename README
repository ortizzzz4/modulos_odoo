l10n_sv_dte/
โ
โโโ ๐ controllers/          # Controladores HTTP (APIs, webhooks)
โ   
โ
โโโ ๐ models/              # Modelos de negocio (lรณgica principal)
โ   โโโ __init__.py
โ   โโโ account_move.py     # Herencia de facturas (DTE)
โ   
โ
โโโ ๐ static/              # Recursos estรกticos
โ   โโโ description/
โ   โ   โโโ icon.png        # Icono del mรณdulo (128x128)
โ   โ   
โ   โโโ src/
โ   โ   โโโ css/           # Estilos personalizados
โ   โ   โโโ js/            # JavaScript (widgets, acciones)
โ   โ   โโโ xml/           # Templates QWeb para JS
โ              
โ
โโโ ๐ tests/               # Tests unitarios y de integraciรณn
โ   โโโ __init__.py
โ   โโโ account_move_test.py      # Tests de facturaciรณn
โ   
โ
โโโ ๐ views/               # Vistas XML (interfaz de usuario)
โ   โโโ account_move_views.xml    # Formularios de facturas
โ   
โ
โโโ ๐ wizards/             # Asistentes (wizards)
โ   โโโ __init__.py
โ   
โโโ ๐ __init__.py          # Inicializaciรณn del mรณdulo
โโโ ๐ __manifest__.py      # Metadatos y dependencias
โโโ ๐ LICENSE              # Licencia del software
โโโ ๐ README.md            # Documentaciรณn principal

๐ Flujo de Datos

โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        Usuario POS       โ
โ     (Frontend OWL)       โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
             โ
             โ 1) Click en "Pagar"
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      POS Backend (Odoo 18)       โ
โ     Modelo: pos.order            โ
โ   Mรฉtodo override: create_from_uiโ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โ 2) POS genera los datos DTE
             โ    prepare_dte_data(order)
             โ      โโ items
             โ      โโ receptor
             โ      โโ emisor
             โ      โโ resumen
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        Servicio Firmador         โ
โ          (API Externa)           โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ
             โ 3) Devuelve XML/JSON firmado
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        pos.order (Odoo 18)       โ
โ  Campos nuevos en tu mรณdulo:     โ
โ   dte_firmado                    โ
โ   estado_dte = 'firmado'         โ
โ                                  โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โ 4) Odoo crea el account.move
             โ    (factura automรกtica desde POS)
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ       Modelo: account.move       โ
โ  Copia automรกtica desde pos.orderโ
โ    dte_firmado                   โ
โ    estado_dte = 'firmado'        โ
โ    tipo_dte / numero_control     โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โ 5) Click "Enviar a MH" en factura
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ    API Ministerio de Hacienda    โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ
             โ 6) Respuesta (acuse + sello)
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        account.move              โ
โ  sello_mh (JWT/acuse)            โ
โ  estado_dte = 'procesado'        โ
โ  uuid / numero_control_final     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
